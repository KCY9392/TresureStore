

# TresureStore Project
### <img src="https://user-images.githubusercontent.com/113049166/222701255-57c223fd-a368-4b50-9652-4ed673b8bbc9.png"  width="30px" height="30px"> [보물상점] 중고물품 거래 웹사이트

<br>
<img src="https://user-images.githubusercontent.com/113049166/222695436-f13080cf-3368-4ac3-bd54-d8d846da79db.png">

<br>

## <img src="https://user-images.githubusercontent.com/113049166/222699301-ce14e886-186b-4241-91fc-132ba832cbe9.png" width="35px" height="35px"> 프로젝트소개

 <img src="https://user-images.githubusercontent.com/113049166/222696648-d8bdf736-c709-49b7-813b-c4af698b87b2.png" width="80%" height="20%">

<br>

## <img src="https://user-images.githubusercontent.com/113049166/222700339-680fc1d0-6047-48e2-8f3e-4c55c9916e82.png" width="35px" height="35px"> 업무분담

 <img src="https://user-images.githubusercontent.com/113049166/222700655-f33dfb56-5f10-456e-8dbd-236d120398b9.png" width="80%" height="20%">

<table style="margin-left: auto; margin-right: auto; width: 600px; height: 200px;">
            <tr>
                <td>이름</td>
                <td>김채영</td>
                <td>정승필</td>
                <td>김혜리</td>
                <td>윤현희</td>
                <td>유홍상</td>
            </tr>
            <tr>
                <td>GitHub</td>
                <td><a href="https://github.com/KCY9392">@KCY9392</a></td>
                <td><a href="https://github.com/Ssspil">@Aox</a></td>
                <td><a href="https://github.com/hyerikimm">@hyerikimm</a></td>
                <td><a href="https://github.com/yoonhh">@yoonhh</a></td>
                <td><a href="https://github.com/sang-3">@sang-3</a></td>
            </tr>
  </table>
  
  <br>
  
## :computer: 개발환경
### :pencil: Front-End
<div>
	<img src="https://img.shields.io/badge/HTML5-E34F26?style=flat&logo=HTML5&logoColor=white" />
	<img src="https://img.shields.io/badge/CSS3-1572B6?style=flat&logo=CSS3&logoColor=white" />
	<img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=flat&logo=JavaScript&logoColor=white" />
	<img src="https://img.shields.io/badge/jQuery-0769AD?style=flat&logo=jQuery&logoColor=white" />	
	<img src="https://img.shields.io/badge/Bootstrap-7952B3?style=flat&logo=Bootstrap&logoColor=white" />
</div>

 ### :pencil: Back-End
<div>
	<img src="https://img.shields.io/badge/Java-007396?style=flat&logo=Java&logoColor=white" />
	<img src="https://img.shields.io/badge/Oracle-F80000?style=flat&logo=Oracle&logoColor=white" />
	<img src="https://img.shields.io/badge/Apache Tomcat-F8DC75?style=flat&logo=Apache Tomcat&logoColor=white" />
	<img src="https://user-images.githubusercontent.com/113049166/222707121-ef026546-b995-4c35-8cdd-5dcd1e5825d5.svg" />
	<img src="https://user-images.githubusercontent.com/113049166/222707252-fc23c89e-a4f6-49a0-b550-7b26aa323fad.svg" />
	<img src="https://user-images.githubusercontent.com/113049166/222707283-1d75770f-1c1d-441d-bccf-2d045850600f.svg" />
	<img src="https://user-images.githubusercontent.com/113049166/222707320-eada9a30-6441-4f77-aea9-511da0362e0b.svg" />

</div>

<br>

 ## :computer: Tool	
<div>
   <img src="https://img.shields.io/badge/STS-2C2255?style=flat&logo=Spring IDE&logoColor=#6DB33F" />
   <img src="https://user-images.githubusercontent.com/113049166/222707017-2ccd3220-e336-4d1f-8d7d-17bc07615d48.svg" />
   <img src="https://img.shields.io/badge/GitHub-181717?style=flat&logo=GitHub&logoColor=white" />	
</div>

<br>

## :book: 프로젝트 작업 기간
- 2022.12.29-2023.01.04 : 프로젝트 기획 및 요구사항 분석
- 2023.01.05-2023.01.11 : 화면설계 
- 2023.01.12-2023.01.13 : DB설계
- 2023.01.19-2023.02.16 : 기능 구현
  
<br>

## 😀 ER-DIAGRAM , USECASE-DIAGRAM
<table>
<tr>
	<th>
	  ER-DIAGRAM
	</th>
	<th>
	  USECASE-DIAGRAM
	</th>
</tr>
<tr>
	<td width="50%">
		<img src="https://user-images.githubusercontent.com/113049166/222722892-fd716e8b-8de9-4f7d-8206-1b8993e2c24e.jpg" width="600" height="200"/>
	</td>
	<td width="50%">
		<img src="https://user-images.githubusercontent.com/113049166/222723157-864adf0f-36a5-4256-b1fa-8153fc27f898.jpg" width="600" height="200"></td>
</tr>
</table>

<br>

## 😆 UI
<table>
<tr>
	<th>
		메인페이지
	</th>
	<th>
		관리자페이지
	</th>

</tr>
<tr>
	<td width="30%">
		<img src="https://user-images.githubusercontent.com/113049166/222708107-e9567d1e-0a52-4c72-b546-c8562671d771.png" width="600" height="200"/>
	</td>
	<td width="30%">
		<img src="https://user-images.githubusercontent.com/113049166/222708667-134c4720-c6f2-49bc-92a3-d8940ce9fc5c.png" width="600" height="200"></td>

</tr>
<tr>
	<th>
	    상품등록하기
	</th>
	<th>상품상세보기</th>
</tr>
<tr>
	<td>
	 <img src="https://user-images.githubusercontent.com/113049166/222710526-eaf342a9-0fa7-4706-8e14-3080a583f816.png" width="600" height="200"/>
	</td>
	<td>
	  <img src="https://user-images.githubusercontent.com/113049166/222710611-4ab64840-5f38-48bc-a490-2e95b9918021.png" width="600" height="200"/>
	</td>
</tr>
<tr>
	<th>채팅방목록
	</th>
	<th>
	    채팅창
	</th>
</tr>
<tr>
	<td>
	  <img src="https://user-images.githubusercontent.com/113049166/222710675-2151095c-77f8-4fe6-8dde-3a4151dc3a3a.png" width="600" height="200"/>
	</td>
	<td>
	  <img src="https://user-images.githubusercontent.com/113049166/222710805-367c4898-23d4-4525-b476-68750a696877.png" width="600" height="200"/>
	</td>
<tr>
<tr>
	<th>내상점
	</th>
	<th>
	    내상점 찜목록
	</th>
</tr>
<tr>
	<td>
	   <img src="https://user-images.githubusercontent.com/113049166/222710884-a3f5ab8e-4777-407e-adbb-81c19d62b7de.png" width="600" height="200"/>
	</td>
	<td>
	   <img src="https://user-images.githubusercontent.com/113049166/222711021-ae1ba4b2-4b69-4533-b266-df2b46fd8e6a.png" width="600" height="200"/>
	</td>
<tr>
</table>

<br>
  
## 🌟 주요기능
#### 1) 채팅첨부파일 보내기 기능

<img src="https://user-images.githubusercontent.com/113049166/222718256-1cf90370-c99d-4f9d-b6e3-24cd6e9f16c2.png" width="80%" height="20%">

	/* 채팅 보내기 버튼 눌렀을 경우, */
           $("#send").on('click',function(){
        	   $.ajax({
                   type: "post",
                   url: "${pageContext.request.contextPath}/chat/chatFile/insert",
                   data: new FormData($("#uploadfileForm")[0]),
                   processData: false,
                   contentType: false,
                   success: function (rsp) {
                	   
                	   let changeName = rsp.changeName;
                       let originName = rsp.originName;
                	   
                       let ext = originName.split('.').pop().toLowerCase();
                       if ($.inArray(ext, ['jpg', 'jpeg', 'png', 'gif']) != -1) {
                    	   
                    	   let wsJson = {
                    			   "chatContent": "<img src='/tresure/resources/images/chat/"+changeName+"' style='width: 200px'><br>",
                    			   "chatRoomNo": chatRoomNo,
                                   "userNo": userNo
                    	   };
                    	   //JSON 전송
                           $("#uploadfile").val("");
                           ws.send(JSON.stringify(wsJson));
                           $(".chatImageBeforeSetImage").css('display','none');
                           $('#View').attr('src', "");
                           return false;
                       }
                	   
                   },
                   error : function(data){
                	 alert("오류");   
                   }
                });
           });
	   

1. [보내기] 버튼 누를경우, ajax로 input file안의 데이터를 form으로 감싸서 chatFile/insert url로 post방식으로 보냅니다. 
2. 이미지 데이터를 받은 controller에서 이미지를 저장할 서버저장폴더를 생성,이미지 저장하고
3. DB에 이미지를 등록시키도록 service단으로 이미지객체를 넘깁니다. 
4. 이미지의 원본명, 수정명을 map에 담아서 ajax결과값으로 보내주고, 그 결과값인 이미지 정보를 이미지태그로 만들고, Json객체로 감싸서 Websocket에 send합니다.
5. 그 결과, 채팅창에 이미지가 출력됩니다.

<br><br>
#### 2) 최근 본 상품 기능
<table>
<tr>
	<th>
	  아직 상품 조회 X
	</th>
	<th>
	  상품조회
	</th>
	<th>
	  상품 조회 시,
	</th>
</tr>
<tr>
	<td width="10%">
		<img src="https://user-images.githubusercontent.com/113049166/222720430-4e92aa76-e435-4bbe-9f24-fb811c8abb7b.png" width="600" height="200"/>
	</td>
	<td width="30%">
		<img src="https://user-images.githubusercontent.com/113049166/222720807-f550b0b2-3bdf-4fe1-8ffd-7e42a13c6d27.png" width="600" height="200"></td>
	<td width="10%">
		<img src="https://user-images.githubusercontent.com/113049166/222720824-7beb0401-97af-4b95-a07e-ad04cdf4266f.png" width="600" height="200"></td>
</tr>
</table>

	// localStorage에서 products 키값 가져오기.
	let sideBarProducts = localStorage.getItem("products");

	// 만약 products가 undefined가 아니라면 list 변수에 JSON.parse(sideBarProducts)를 통해서 JSON Array를 만들고, 그게 아니라면 list 변수를 새로운 배열로 생성한다.
	let sideBarList = sideBarProducts ? JSON.parse(sideBarProducts) : [];

	<c:choose>
		<c:when test="${sessionScope.loginUser != null}">
			let sideBarUrl = "${pageContext.request.contextPath}/recent/" + (sideBarList ? "update" : "products");

			$.ajax({
				   async : false,
				   url : sideBarUrl,
				   data : JSON.stringify(sideBarList),
				   type : "post",
				   dataType : "json",
				   contentType : "application/json",
				   success : function(data) {

					localStorage.removeItem("products");
					$("#nrecentlyList").children().remove();
					$(data).each((i, elem) => {
						if (elem.crawl == "N") {
							elem.imgSrc = "${pageContext.request.contextPath}" + elem.imgSrc;
						}
						console.log("로그인 된 상태 -> href : ${pageContext.request.contextPath}/sell/sellDetail/" 
								+ elem.sellNo, ", imgSrc :", elem.imgSrc, ", crawl:", elem.crawl);
						$("#nrecentlyList").append($("<li>")
								   .append($("<a>", { href : "${pageContext.request.contextPath}/sell/sellDetail/" + elem.sellNo })
								   .append($("<img>", { src : elem.imgSrc }).addClass("nrecentlyImage")))
								   .append($("<input>", {type : "hidden", name : "recentNo", value : elem.recentNo}))
								   .append($("<input>", {type : "hidden", name : "sellNo", value : elem.sellNo}))
								   .append($("<input>", {type : "hidden", name : "imgSrc", value : elem.imgSrc}))
								   .append($("<input>", {type : "hidden", name : "crawl", value : elem.crawl}))
								   .append($("<button>", { text : "X", class : "deleteBtn" })))
						});
						$("#nrecentlyCnt").text(data.length);
					},
				   error : function() {
						console.log("오류 발생");
					}
				});
		</c:when>
	<c:otherwise>


- 로컬스토리지를 이용하여서 상품을 클릭 시, 상품상세페이지로 이동할때 상품정보를 로컬스토리지에 세팅하는 스크립트를 사용하였습니다. 
1. item변수에 상품객체를 담고, 
2. 2개이상의 상품을 저장하기위해 다시 list배열에 담아 로컬스토리지 키값에 저장시킵니다.
3. 이때의 키값을 sidebar.jsp에 전달시키고 이미지를 출력합니다.

<br><br>







